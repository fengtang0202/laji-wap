webpackJsonp([14],{280:function(t,e,o){function i(t){o(618)}var n=o(0)(o(456),o(748),i,"data-v-b4f15cda",null);t.exports=n.exports},327:function(t,e,o){"use strict";function i(t){return void 0===t?document.body:"string"==typeof t&&0===t.indexOf("?")?document.body:("string"==typeof t&&t.indexOf("?")>0&&(t=t.split("?")[0]),"body"===t||!0===t?document.body:t instanceof window.Node?t:document.querySelector(t))}function n(t){if(!t)return!1;if("string"==typeof t&&t.indexOf("?")>0)try{return JSON.parse(t.split("?")[1]).autoUpdate||!1}catch(t){return!1}return!1}var s=o(46),a={inserted:function(t,e,o){var n=e.value;t.className=t.className?t.className+" v-transfer-dom":"v-transfer-dom";var s=t.parentNode,a=document.createComment(""),r=!1;!1!==n&&(s.replaceChild(a,t),i(n).appendChild(t),r=!0),t.__transferDomData||(t.__transferDomData={parentNode:s,home:a,target:i(n),hasMovedOut:r})},componentUpdated:function(t,e){var o=e.value;if(n(o)){var a=t.__transferDomData,r=a.parentNode,u=a.home,l=a.hasMovedOut;!l&&o?(r.replaceChild(u,t),i(o).appendChild(t),t.__transferDomData=s({},t.__transferDomData,{hasMovedOut:!0,target:i(o)})):l&&!1===o?(r.replaceChild(t,u),t.__transferDomData=s({},t.__transferDomData,{hasMovedOut:!1,target:i(o)})):o&&i(o).appendChild(t)}},unbind:function(t,e){t.className=t.className.replace("v-transfer-dom",""),t.__transferDomData&&!0===t.__transferDomData.hasMovedOut&&t.__transferDomData.parentNode&&t.__transferDomData.parentNode.appendChild(t),t.__transferDomData=null}};e.a=a},329:function(t,e,o){"use strict";e.a={hasClass:function(t,e){return new RegExp("(\\s|^)"+e+"(\\s|$)").test(t.className)},addClass:function(t,e){t&&(t.classList?t.classList.add(e):this.hasClass(t,e)||(t.className+=""+e))},removeClass:function(t,e){t&&(t.classList?t.classList.remove(e):this.hasClass(t,e)&&(t.className=t.className.replace(new RegExp("(\\s|^)"+e+"(\\s|$)")," ").replace(/^\s+|\s+$/g,"")))}}},330:function(t,e,o){e=t.exports=o(43)(!1),e.push([t.i,".vux-modal-open{overflow:hidden;position:fixed;width:100%}.vux-modal-open-for-container{overflow:hidden!important}",""])},332:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=o(50),n=o.n(i),s=o(333),a=o(329);e.default={name:"popup",props:{value:Boolean,height:{type:String,default:"auto"},width:{type:String,default:"auto"},showMask:{type:Boolean,default:!0},isTransparent:Boolean,hideOnBlur:{type:Boolean,default:!0},position:{type:String,default:"bottom"},maxHeight:String,popupStyle:Object,hideOnDeactivated:{type:Boolean,default:!0},shouldRerenderOnShow:{type:Boolean,default:!1},shouldScrollTopOnShow:{type:Boolean,default:!1}},created:function(){this.$vux&&this.$vux.config&&"VIEW_BOX"===this.$vux.config.$layout&&(this.layout="VIEW_BOX")},mounted:function(){var t=this;this.$overflowScrollingList=document.querySelectorAll(".vux-fix-safari-overflow-scrolling"),this.$nextTick(function(){var e=t;t.popup=new s.a({showMask:e.showMask,container:e.$el,hideOnBlur:e.hideOnBlur,onOpen:function(){e.fixSafariOverflowScrolling("auto"),e.show=!0},onClose:function(){e.show=!1,window.__$vuxPopups&&n()(window.__$vuxPopups).length>1||document.querySelector(".vux-popup-dialog.vux-popup-mask-disabled")||setTimeout(function(){e.fixSafariOverflowScrolling("touch")},300)}}),t.value&&t.popup.show(),t.initialShow=!1})},deactivated:function(){this.hideOnDeactivated&&(this.show=!1),this.removeModalClassName()},methods:{fixSafariOverflowScrolling:function(t){if(this.$overflowScrollingList.length)for(var e=0;e<this.$overflowScrollingList.length;e++)this.$overflowScrollingList[e].style.webkitOverflowScrolling=t},removeModalClassName:function(){"VIEW_BOX"===this.layout&&a.a.removeClass(document.body,"vux-modal-open")},doShow:function(){this.popup&&this.popup.show(),this.$emit("on-show"),this.fixSafariOverflowScrolling("auto"),"VIEW_BOX"===this.layout&&a.a.addClass(document.body,"vux-modal-open"),this.hasFirstShow||(this.$emit("on-first-show"),this.hasFirstShow=!0)},scrollTop:function(){var t=this;this.$nextTick(function(){t.$el.scrollTop=0;var e=t.$el.querySelectorAll(".vux-scrollable");if(e.length)for(var o=0;o<e.length;o++)e[o].scrollTop=0})}},data:function(){return{layout:"",initialShow:!0,hasFirstShow:!1,shouldRenderBody:!0,show:this.value}},computed:{styles:function(){var t={};if(this.position&&"bottom"!==this.position&&"top"!==this.position?t.width=this.width:t.height=this.height,this.maxHeight&&(t["max-height"]=this.maxHeight),this.isTransparent&&(t.background="transparent"),this.popupStyle)for(var e in this.popupStyle)t[e]=this.popupStyle[e];return t}},watch:{value:function(t){this.show=t},show:function(t){var e=this;this.$emit("input",t),t?this.shouldRerenderOnShow?(this.shouldRenderBody=!1,this.$nextTick(function(){e.scrollTop(),e.shouldRenderBody=!0,e.doShow()})):(this.shouldScrollTopOnShow&&this.scrollTop(),this.doShow()):(this.$emit("on-hide"),this.show=!1,this.popup.hide(!1),setTimeout(function(){document.querySelector(".vux-popup-dialog.vux-popup-show")||e.fixSafariOverflowScrolling("touch"),e.removeModalClassName()},200))}},beforeDestroy:function(){this.popup&&this.popup.destroy(),this.fixSafariOverflowScrolling("touch"),this.removeModalClassName()}}},333:function(t,e,o){"use strict";var i=o(51),n=o.n(i),s=o(334),a="object"===("undefined"==typeof window?"undefined":n()(window));a&&(window.__$vuxPopups=window.__$vuxPopups||{});var r=function(t){var e=this;if(a){this.uuid=Math.random().toString(36).substring(3,8),this.params={},"[object Object]"===Object.prototype.toString.call(t)&&(this.params={hideOnBlur:t.hideOnBlur,onOpen:t.onOpen||function(){},onClose:t.onClose||function(){},showMask:t.showMask}),!!document.querySelectorAll(".vux-popup-mask").length<=0&&(this.divMask=document.createElement("a"),this.divMask.className="vux-popup-mask",this.divMask.dataset.uuid="",this.divMask.href="javascript:void(0)",document.body.appendChild(this.divMask));var o=void 0;o=t.container?t.container:document.createElement("div"),o.className+=" vux-popup-dialog vux-popup-dialog-"+this.uuid,this.params.hideOnBlur||(o.className+=" vux-popup-mask-disabled"),this.div=o,t.container||document.body.appendChild(o),this.container=document.querySelector(".vux-popup-dialog-"+this.uuid),this.mask=document.querySelector(".vux-popup-mask"),this.mask.dataset.uuid+=","+this.uuid,this._bindEvents(),t=null,this.containerHandler=function(){e.mask&&!/show/.test(e.mask.className)&&setTimeout(function(){!/show/.test(e.mask.className)&&(e.mask.style.zIndex=-1)},200)},this.container&&this.container.addEventListener("webkitTransitionEnd",this.containerHandler),this.container&&this.container.addEventListener("transitionend",this.containerHandler)}};r.prototype.onClickMask=function(){this.params.hideOnBlur&&this.params.onClose()},r.prototype._bindEvents=function(){this.params.hideOnBlur&&(this.mask.addEventListener("click",this.onClickMask.bind(this),!1),this.mask.addEventListener("touchmove",function(t){return t.preventDefault()},!!s&&{passive:!1}))},r.prototype.show=function(){this.params.showMask&&(this.mask.classList.add("vux-popup-show"),this.mask.style.zIndex=500),this.container.classList.add("vux-popup-show"),this.params.onOpen&&this.params.onOpen(this),a&&(window.__$vuxPopups[this.uuid]=1)},r.prototype.hide=function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.container.classList.remove("vux-popup-show"),document.querySelector(".vux-popup-dialog.vux-popup-show")||(this.mask.classList.remove("vux-popup-show"),setTimeout(function(){t.mask&&!/show/.test(t.mask.className)&&(t.mask.style.zIndex=-1)},400)),!1===e&&this.params.onClose&&this.params.hideOnBlur&&this.params.onClose(this),this.isShow=!1,a&&delete window.__$vuxPopups[this.uuid]},r.prototype.destroy=function(){this.mask.dataset.uuid=this.mask.dataset.uuid.replace(new RegExp(","+this.uuid,"g"),""),this.mask.dataset.uuid?this.hide():(this.mask.removeEventListener("click",this.onClickMask.bind(this),!1),this.mask&&this.mask.parentNode&&this.mask.parentNode.removeChild(this.mask)),this.container.removeEventListener("webkitTransitionEnd",this.containerHandler),this.container.removeEventListener("transitionend",this.containerHandler),a&&delete window.__$vuxPopups[this.uuid]},e.a=r},334:function(t,e){var o=!1;try{var i=Object.defineProperty({},"passive",{get:function(){o=!0}});window.addEventListener("test",null,i)}catch(t){}t.exports=o},335:function(t,e,o){e=t.exports=o(43)(!1),e.i(o(330),""),e.push([t.i,".vux-popup-dialog{position:fixed;left:0;bottom:0;width:100%;background:#eee;z-index:501;-webkit-transition-property:-webkit-transform;transition-property:-webkit-transform;transition-property:transform;transition-property:transform,-webkit-transform;-webkit-transition-duration:.3s;transition-duration:.3s;max-height:100%;overflow-y:scroll;-webkit-overflow-scrolling:touch}.vux-popup-dialog.vux-popup-left{width:auto;height:100%;top:0;right:auto;bottom:auto;left:0}.vux-popup-dialog.vux-popup-right{width:auto;height:100%;top:0;right:0;bottom:auto;left:auto}.vux-popup-dialog.vux-popup-top{width:100%;top:0;right:auto;bottom:auto;left:0}.vux-popup-mask{display:block;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.5);opacity:0;tap-highlight-color:transparent;z-index:-1;-webkit-transition:opacity .4s;transition:opacity .4s}.vux-popup-mask.vux-popup-show{opacity:1}.vux-popup-animate-bottom-enter,.vux-popup-animate-bottom-leave-active{-webkit-transform:translate3d(0,100%,0);transform:translate3d(0,100%,0)}.vux-popup-animate-left-enter,.vux-popup-animate-left-leave-active{-webkit-transform:translate3d(-100%,0,0);transform:translate3d(-100%,0,0)}.vux-popup-animate-right-enter,.vux-popup-animate-right-leave-active{-webkit-transform:translate3d(100%,0,0);transform:translate3d(100%,0,0)}.vux-popup-animate-top-enter,.vux-popup-animate-top-leave-active{-webkit-transform:translate3d(0,-100%,0);transform:translate3d(0,-100%,0)}",""])},336:function(t,e,o){var i=o(335);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);o(44)("5e90dcb4",i,!0,{})},338:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("transition",{attrs:{name:"vux-popup-animate-"+t.position}},[o("div",{directives:[{name:"show",rawName:"v-show",value:t.show&&!t.initialShow,expression:"show && !initialShow"}],staticClass:"vux-popup-dialog",class:["vux-popup-"+t.position,t.show?"vux-popup-show":""],style:t.styles},[t.shouldRenderBody?t._t("default"):t._e()],2)])},staticRenderFns:[]}},339:function(t,e,o){function i(t){o(336)}var n=o(0)(o(332),o(338),i,null,null);t.exports=n.exports},456:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=o(104),n=o.n(i),s=o(45),a=o(18),r=o(339),u=o.n(r),l=o(327);e.default={components:{Popup:u.a},directives:{TransferDom:l.a},data:function(){return{topList:{title_1:"评论",title_2:"首页",link:"/"},showNoContent:!1,showContent:!1,timer:"",show:!1,replyText:"",hotCommentList:[],hotCommentcount:0,newCommentList:[],newCommentcount:0,bookName:"",readBookId:this.$route.query.bookId,page:0}},computed:n()({},o.i(a.a)(["userInfo","isLogin"])),methods:{canlce:function(){this.show=!1},getHotComment:function(){var t=this;o.i(s.a)(this,{bookid:this.readBookId},"/api/comm-HotCommentInfo",function(e){200==e.returnCode?(t.hotCommentList=e.data,t.hotCommentcount=e.data.length,console.log(t.hotCommentList),t.showContent=!0):800===e.returnCode&&(t.showNoContent=!0)})},handleMakeComment:function(){var t=this,e=this.replyText.length;if(/[\ud83c-\ud83e][\udc00-\udfff]|[\u2600-\u27ff]/.test(this.replyText))this.$vux.toast.show({text:"目前不支持表情!",type:"cancel"});else if(e>0){var i={bookId:this.readBookId,commentContext:this.replyText,userName:this.userName,bookName:this.bookName};o.i(s.a)(this,i,"/api/add-getcomminfo",function(e){200==e.returnCode?(t.$vux.toast.text("发表成功!"),t.show=!1,t.showContent=!0,i.isthumbs=0,i.thumbsCount=0,i.replyCount=0,i.userSex=t.userInfo.userSex,i.userHeadPortraitURL=t.userInfo.userHeadPortraitURL,i.pseudonym=t.userInfo.pseudonym,i.userGrade=t.userInfo.userGrade,i.commentDateTime=t.timer,t.newCommentcount+=1,t.newCommentList.unshift(i)):400==e.returnCode?t.$router.push({path:"/Login",query:{redirect:t.$route.path+"?bookId="+t.readBookId}}):t.$vux.toast.text(e.msg)})}else this.$vux.toast.text("评价不能为空!")},infiniteHandler:function(t){var e=this;this.page+=1,o.i(s.a)(this,{id:this.readBookId,type:1,startPage:this.page},"/api/comm-getcomminfo",function(o){200==o.returnCode?(e.newCommentList=e.newCommentList.concat(o.data.list),e.newCommentcount=o.data.total,o.data.lastPage>e.page?t.loaded():t.complete()):t.complete()})},getNewComment:function(){var t=this;o.i(s.a)(this,{id:this.readBookId,type:1,startPage:1},"/api/comm-getcomminfo",function(e){200==e.returnCode&&0!=e.data.list.length?(t.showContent=!0,t.newCommentList=e.data.list,t.newCommentcount=e.data.list.length,t.bookName=e.data.list[0].bookName):t.showNoContent=!0})},getTime:function(){var t=this;o.i(s.b)(this,"/api/sys-getNetWorkDateTime",function(e){t.timer=e.data.beijing})},handlereplyDetail:function(t){console.log(t)},handleShow:function(){this.isLogin?this.show=!this.show:this.$router.push({path:"/Login",query:{redirect:this.$route.path+"?bookId="+this.readBookId}})}},mounted:function(){this.getHotComment(),this.getTime()}}},559:function(t,e,o){e=t.exports=o(43)(!1),e.push([t.i,".book_comment_wrap[data-v-b4f15cda]{width:100%}.book_comment_wrap img[data-v-b4f15cda]{vertical-align:middle}.book_comment_wrap .book_hot_comment p[data-v-b4f15cda]{margin-left:.14rem;margin-top:.19rem;margin-bottom:.18rem}.book_comment_wrap .bottom_x[data-v-b4f15cda]{width:100%;height:.4rem}.book_comment_wrap .replyInput[data-v-b4f15cda]{width:100%;border-top:1px solid #efefef;height:.4rem;background-color:#fff;position:fixed;bottom:0;line-height:.4rem;color:#f77583;text-align:center}.book_comment_wrap .more[data-v-b4f15cda]{font-size:.16rem;color:#f77583;text-align:center;border-bottom:1px solid #efefef}",""])},618:function(t,e,o){var i=o(559);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);o(44)("c8125cec",i,!0,{})},748:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"book_comment_wrap"},[o("headerComponent",{attrs:{list:t.topList}}),t._v(" "),t.showContent?o("div",[o("div",{staticClass:"book_hot_comment"},[o("p",{staticStyle:{"font-szie":".18rem"}},[o("span",{staticStyle:{color:"#F77583","font-weight":"600"}},[t._v("|")]),t._v("热门评论("+t._s(t.hotCommentcount)+")")]),t._v(" "),o("commendItem",{attrs:{list:t.hotCommentList}})],1),t._v(" "),o("div",{staticClass:"book_hot_comment"},[o("p",{staticStyle:{"font-szie":".18rem"}},[o("span",{staticStyle:{color:"#F77583","font-weight":"600"}},[t._v("|")]),t._v("最新评论("+t._s(t.newCommentcount)+")")]),t._v(" "),o("commendItem",{attrs:{list:t.newCommentList}}),t._v(" "),o("infinite-loading",{on:{infinite:t.infiniteHandler}},[o("span",{attrs:{slot:"no-more"},slot:"no-more"},[t._v("\n                 目前暂无更多评论\n             ")]),t._v(" "),o("span",{attrs:{slot:"no-results"},slot:"no-results"},[t._v("\n                 目前暂无更多评论\n             ")])])],1)]):t._e(),t._v(" "),t.showNoContent?o("No",{attrs:{message:"暂无评论"}}):t._e(),t._v(" "),o("div",{staticClass:"bottom_x"}),t._v(" "),o("div",{staticClass:"replyInput",on:{click:function(e){t.handleShow()}}},[o("span",[t._v("发表评价")])]),t._v(" "),o("div",{directives:[{name:"transfer-dom",rawName:"v-transfer-dom"}]},[o("popup",{model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[o("div",{staticStyle:{overflow:"hidden",height:"1.5rem","font-size":".16rem","background-color":"#fff"}},[o("div",{staticStyle:{"border-bottom":"1px solid #E9E9E9",overflow:"hidden",padding:".08rem .2rem"}},[o("p",{staticStyle:{float:"left"},on:{click:function(e){t.canlce()}}},[t._v("取消")]),t._v(" "),o("p",{staticStyle:{color:"#F77583",float:"right"},on:{click:function(e){t.handleMakeComment()}}},[t._v("发表")])]),t._v(" "),o("div",{staticClass:"text_box"},[o("textarea",{directives:[{name:"focus",rawName:"v-focus"},{name:"model",rawName:"v-model",value:t.replyText,expression:"replyText"}],staticStyle:{width:"100%",height:"1.2rem",border:"0",outline:"none",padding:".1rem"},attrs:{placeholder:"请输入你对这本书的评价..."},domProps:{value:t.replyText},on:{input:function(e){e.target.composing||(t.replyText=e.target.value)}}})])])])],1)],1)},staticRenderFns:[]}}});